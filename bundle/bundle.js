var supertokens;(()=>{"use strict";var e={759:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}u((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.responseErrorInterceptor=t.responseInterceptor=t.interceptorFunctionRequestFulfilled=void 0;var i=n(600),a=n(379),u=n(743),c=n(318),l=n(958),d=n(845);function f(e){var t=void 0===e.url?"":e.url,n=e.baseURL;return void 0!==n&&(t="/"===t.charAt(0)&&"/"===n.charAt(n.length-1)?n+t.substr(1):"/"!==t.charAt(0)&&"/"!==n.charAt(n.length-1)?n+"/"+t:n+t),t}t.interceptorFunctionRequestFulfilled=function(e){return o(this,void 0,void 0,(function(){var t,n,o,i,g;return s(this,(function(s){switch(s.label){case 0:(0,d.logDebugMessage)("interceptorFunctionRequestFulfilled: started axios interception"),t=f(e),n=!1;try{n="string"==typeof t&&!(0,c.shouldDoInterceptionBasedOnUrl)(t,a.default.config.apiDomain,a.default.config.cookieDomain)}catch(e){if("Please provide a valid domain name"!==e.message)throw e;(0,d.logDebugMessage)("interceptorFunctionRequestFulfilled: Trying shouldDoInterceptionBasedOnUrl with location.origin"),n=!(0,c.shouldDoInterceptionBasedOnUrl)(l.default.getReferenceOrThrow().windowHandler.location.getOrigin(),a.default.config.apiDomain,a.default.config.cookieDomain)}return(0,d.logDebugMessage)("interceptorFunctionRequestFulfilled: Value of doNotDoInterception: "+n),n?((0,d.logDebugMessage)("interceptorFunctionRequestFulfilled: Returning config unchanged"),[2,e]):((0,d.logDebugMessage)("interceptorFunctionRequestFulfilled: Modifying config"),u.ProcessState.getInstance().addState(u.PROCESS_STATE.CALLING_INTERCEPTION_REQUEST),[4,(0,a.getIdRefreshToken)(!0)]);case 1:return o=s.sent(),i=e,"EXISTS"!==o.status?[3,3]:[4,a.AntiCsrfToken.getToken(o.token)];case 2:void 0!==(g=s.sent())&&((0,d.logDebugMessage)("interceptorFunctionRequestFulfilled: Adding anti-csrf token to request"),i=r(r({},i),{headers:void 0===i?{"anti-csrf":g}:r(r({},i.headers),{"anti-csrf":g})})),s.label=3;case 3:return a.default.config.autoAddCredentials&&void 0===i.withCredentials&&((0,d.logDebugMessage)("interceptorFunctionRequestFulfilled: Adding credentials include"),i=r(r({},i),{withCredentials:!0})),(0,d.logDebugMessage)("interceptorFunctionRequestFulfilled: Adding rid header: anti-csrf (it may be overriden by the user's provided rid)"),i=r(r({},i),{headers:void 0===i?{rid:"anti-csrf"}:r({rid:"anti-csrf"},i.headers)}),(0,d.logDebugMessage)("interceptorFunctionRequestFulfilled: returning modified config"),[2,i]}}))}))},t.responseInterceptor=function(e){var t=this;return function(n){return o(t,void 0,void 0,(function(){var t,r,o,i,h,p,v,b;return s(this,(function(s){switch(s.label){case 0:t=!1,s.label=1;case 1:if(s.trys.push([1,,13,19]),!a.default.initCalled)throw new Error("init function not called");(0,d.logDebugMessage)("responseInterceptor: started"),(0,d.logDebugMessage)("responseInterceptor: already intercepted: "+n.headers["x-supertokens-xhr-intercepted"]),r=f(n.config);try{t="string"==typeof r&&!(0,c.shouldDoInterceptionBasedOnUrl)(r,a.default.config.apiDomain,a.default.config.cookieDomain)||!!n.headers["x-supertokens-xhr-intercepted"]}catch(e){if("Please provide a valid domain name"!==e.message)throw e;(0,d.logDebugMessage)("responseInterceptor: Trying shouldDoInterceptionBasedOnUrl with location.origin"),t=!(0,c.shouldDoInterceptionBasedOnUrl)(l.default.getReferenceOrThrow().windowHandler.location.getOrigin(),a.default.config.apiDomain,a.default.config.cookieDomain)||!!n.headers["x-supertokens-xhr-intercepted"]}return(0,d.logDebugMessage)("responseInterceptor: Value of doNotDoInterception: "+t),t?((0,d.logDebugMessage)("responseInterceptor: Returning without interception"),[2,n]):((0,d.logDebugMessage)("responseInterceptor: Interception started"),u.ProcessState.getInstance().addState(u.PROCESS_STATE.CALLING_INTERCEPTION_RESPONSE),void 0===(o=n.headers["id-refresh-token"])?[3,3]:((0,d.logDebugMessage)("responseInterceptor: Setting sIRTFrontend: "+o),[4,(0,a.setIdRefreshToken)(o,n.status)]));case 2:s.sent(),s.label=3;case 3:return n.status!==a.default.config.sessionExpiredStatusCode?[3,4]:((0,d.logDebugMessage)("responseInterceptor: Status code is: "+n.status),i=n.config,[2,g.doRequest((function(t){return e(t)}),i,r,n,void 0,!0)]);case 4:return n.status!==a.default.config.invalidClaimStatusCode?[3,6]:[4,(0,a.onInvalidClaimResponse)(n)];case 5:s.sent(),s.label=6;case 6:return void 0===(h=n.headers["anti-csrf"])?[3,9]:[4,(0,a.getIdRefreshToken)(!0)];case 7:return"EXISTS"!==(p=s.sent()).status?[3,9]:((0,d.logDebugMessage)("responseInterceptor: Setting anti-csrf token"),[4,a.AntiCsrfToken.setItem(p.token,h)]);case 8:s.sent(),s.label=9;case 9:return void 0===(v=n.headers["front-token"])?[3,11]:((0,d.logDebugMessage)("responseInterceptor: Setting sFrontToken: "+v),[4,a.FrontToken.setItem(v)]);case 10:s.sent(),s.label=11;case 11:return[2,n];case 12:return[3,19];case 13:return(b=!t)?[4,(0,a.getIdRefreshToken)(!0)]:[3,15];case 14:b=!("EXISTS"===s.sent().status),s.label=15;case 15:return b?((0,d.logDebugMessage)("responseInterceptor: sIRTFrontend doesn't exist, so removing anti-csrf and sFrontToken"),[4,a.AntiCsrfToken.removeToken()]):[3,18];case 16:return s.sent(),[4,a.FrontToken.removeToken()];case 17:s.sent(),s.label=18;case 18:return[7];case 19:return[2]}}))}))}},t.responseErrorInterceptor=function(e){var t=this;return function(n){return o(t,void 0,void 0,(function(){var t;return s(this,(function(r){switch(r.label){case 0:if((0,d.logDebugMessage)("responseErrorInterceptor: called"),(0,d.logDebugMessage)("responseErrorInterceptor: already intercepted: "+(n.response&&n.response.headers["x-supertokens-xhr-intercepted"])),n.response.headers["x-supertokens-xhr-intercepted"])throw n;return void 0===n.response||n.response.status!==a.default.config.sessionExpiredStatusCode?[3,1]:((0,d.logDebugMessage)("responseErrorInterceptor: Status code is: "+n.response.status),t=n.config,[2,g.doRequest((function(t){return e(t)}),t,f(t),void 0,n,!0)]);case 1:return void 0===n.response||n.response.status!==a.default.config.invalidClaimStatusCode?[3,3]:[4,(0,a.onInvalidClaimResponse)(n.response)];case 2:r.sent(),r.label=3;case 3:throw n}}))}))}};var g=function(){function e(){}var t;return t=e,e.doRequest=function(e,n,u,f,g,h){return void 0===h&&(h=!1),o(void 0,void 0,void 0,(function(){var o,p,v,b,m,I,y,w,k,R,S,T,x,D,E,C;return s(t,(function(t){switch(t.label){case 0:if(!a.default.initCalled)throw Error("init function not called");(0,d.logDebugMessage)("doRequest: called"),o=!1;try{o="string"==typeof u&&!(0,c.shouldDoInterceptionBasedOnUrl)(u,a.default.config.apiDomain,a.default.config.cookieDomain)&&h}catch(e){if("Please provide a valid domain name"!==e.message)throw e;(0,d.logDebugMessage)("doRequest: Trying shouldDoInterceptionBasedOnUrl with location.origin"),o=!(0,c.shouldDoInterceptionBasedOnUrl)(l.default.getReferenceOrThrow().windowHandler.location.getOrigin(),a.default.config.apiDomain,a.default.config.cookieDomain)&&h}if((0,d.logDebugMessage)("doRequest: Value of doNotDoInterception: "+o),!o)return[3,2];if((0,d.logDebugMessage)("doRequest: Returning without interception"),void 0!==g)throw g;return void 0!==f?[2,f]:[4,e(n)];case 1:return[2,t.sent()];case 2:(0,d.logDebugMessage)("doRequest: Interception started"),t.label=3;case 3:t.trys.push([3,,45,50]),p=void 0,t.label=4;case 4:return[4,(0,a.getIdRefreshToken)(!0)];case 5:return v=t.sent(),b=n,"EXISTS"!==v.status?[3,7]:[4,a.AntiCsrfToken.getToken(v.token)];case 6:void 0!==(k=t.sent())&&((0,d.logDebugMessage)("doRequest: Adding anti-csrf token to request"),b=r(r({},b),{headers:void 0===b?{"anti-csrf":k}:r(r({},b.headers),{"anti-csrf":k})})),t.label=7;case 7:a.default.config.autoAddCredentials&&void 0===b.withCredentials&&((0,d.logDebugMessage)("doRequest: Adding credentials include"),b=r(r({},b),{withCredentials:!0})),(0,d.logDebugMessage)("doRequest: Adding rid header: anti-csrf (May get overriden by user's rid)"),b=r(r({},b),{headers:void 0===b?{rid:"anti-csrf"}:r({rid:"anti-csrf"},b.headers)}),t.label=8;case 8:if(t.trys.push([8,29,,43]),m=g,I=f,g=void 0,f=void 0,void 0!==m)throw(0,d.logDebugMessage)("doRequest: Not making call because localPrevError is not undefined"),m;return void 0!==I?(0,d.logDebugMessage)("doRequest: Not making call because localPrevResponse is not undefined"):(0,d.logDebugMessage)("doRequest: Making user's http call"),void 0!==I?[3,10]:[4,e(b)];case 9:return y=t.sent(),[3,11];case 10:y=I,t.label=11;case 11:return x=y,(0,d.logDebugMessage)("doRequest: User's http call ended"),void 0===(D=x.headers["id-refresh-token"])?[3,13]:((0,d.logDebugMessage)("doRequest: Setting sIRTFrontend: "+D),[4,(0,a.setIdRefreshToken)(D,x.status)]);case 12:t.sent(),t.label=13;case 13:return x.status!==a.default.config.sessionExpiredStatusCode?[3,20]:((0,d.logDebugMessage)("doRequest: Status code is: "+x.status),[4,(0,a.onUnauthorisedResponse)(v)]);case 14:return"RETRY"===(E=t.sent()).result?[3,19]:((0,d.logDebugMessage)("doRequest: Not retrying original request"),E.error?[4,(0,i.createAxiosErrorFromFetchResp)(E.error)]:[3,16]);case 15:return w=t.sent(),[3,18];case 16:return[4,(0,i.createAxiosErrorFromAxiosResp)(x)];case 17:w=t.sent(),t.label=18;case 18:return p=w,[3,44];case 19:return(0,d.logDebugMessage)("doRequest: Retrying original request"),[3,28];case 20:return x.status!==a.default.config.invalidClaimStatusCode?[3,22]:[4,(0,a.onInvalidClaimResponse)(x)];case 21:t.sent(),t.label=22;case 22:return void 0===(k=x.headers["anti-csrf"])?[3,25]:[4,(0,a.getIdRefreshToken)(!0)];case 23:return"EXISTS"!==(R=t.sent()).status?[3,25]:((0,d.logDebugMessage)("doRequest: Setting anti-csrf token"),[4,a.AntiCsrfToken.setItem(R.token,k)]);case 24:t.sent(),t.label=25;case 25:return void 0===(S=x.headers["front-token"])?[3,27]:((0,d.logDebugMessage)("doRequest: Setting sFrontToken: "+S),[4,a.FrontToken.setItem(S)]);case 26:t.sent(),t.label=27;case 27:return[2,x];case 28:return[3,43];case 29:return T=t.sent(),void 0===(x=T.response)?[3,41]:void 0===(D=x.headers["id-refresh-token"])?[3,31]:((0,d.logDebugMessage)("doRequest: Setting sIRTFrontend: "+D),[4,(0,a.setIdRefreshToken)(D,x.status)]);case 30:t.sent(),t.label=31;case 31:return x.status!==a.default.config.sessionExpiredStatusCode?[3,37]:((0,d.logDebugMessage)("doRequest: Status code is: "+x.status),[4,(0,a.onUnauthorisedResponse)(v)]);case 32:return"RETRY"===(E=t.sent()).result?[3,36]:((0,d.logDebugMessage)("doRequest: Not retrying original request"),void 0===E.error?[3,34]:[4,(0,i.createAxiosErrorFromFetchResp)(E.error)]);case 33:return C=t.sent(),[3,35];case 34:C=T,t.label=35;case 35:return p=C,[3,44];case 36:return(0,d.logDebugMessage)("doRequest: Retrying original request"),[3,40];case 37:return x.status!==a.default.config.invalidClaimStatusCode?[3,39]:[4,(0,a.onInvalidClaimResponse)(x)];case 38:t.sent(),t.label=39;case 39:throw T;case 40:return[3,42];case 41:throw T;case 42:return[3,43];case 43:return[3,4];case 44:throw p;case 45:return[4,(0,a.getIdRefreshToken)(!1)];case 46:return"NOT_EXISTS"!==t.sent().status?[3,49]:((0,d.logDebugMessage)("doRequest: sIRTFrontend doesn't exist, so removing anti-csrf and sFrontToken"),[4,a.AntiCsrfToken.removeToken()]);case 47:return t.sent(),[4,a.FrontToken.removeToken()];case 48:t.sent(),t.label=49;case 49:return[7];case 50:return[2]}}))}))},e}();t.default=g},600:function(e,t){var n=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}u((r=r.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};function o(e,t,n,r,o){return e.config=t,n&&(e.code=n),e.request=r,e.response=o,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}Object.defineProperty(t,"__esModule",{value:!0}),t.createAxiosErrorFromAxiosResp=t.createAxiosErrorFromFetchResp=void 0,t.createAxiosErrorFromFetchResp=function(e){return n(this,void 0,void 0,(function(){var t,n,s,i;return r(this,(function(r){switch(r.label){case 0:if(t={url:e.url,headers:e.headers},null!==(n=e.headers.get("content-type")))return[3,5];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,e.text()];case 2:return s=r.sent(),[3,4];case 3:return r.sent(),s="",[3,4];case 4:return[3,11];case 5:return n.includes("application/json")?[4,e.json()]:[3,7];case 6:return s=r.sent(),[3,11];case 7:return n.includes("text/")?[4,e.text()]:[3,9];case 8:return s=r.sent(),[3,11];case 9:return[4,e.blob()];case 10:s=r.sent(),r.label=11;case 11:return i={data:s,status:e.status,statusText:e.statusText,headers:e.headers,config:t,request:void 0},[2,o(new Error("Request failed with status code "+e.status),t,void 0,void 0,i)]}}))}))},t.createAxiosErrorFromAxiosResp=function(e){return n(this,void 0,void 0,(function(){return r(this,(function(t){return[2,o(new Error("Request failed with status code "+e.status),e.config,void 0,e.request,e)]}))}))}},280:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(569),t)},491:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=this&&this.__assign||function(){return s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},s.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.BooleanClaim=void 0;var i=function(e){function t(t){var n=e.call(this,t)||this;return n.validators=s(s({},n.validators),{isTrue:function(e){return n.validators.hasValue(!0,e)},isFalse:function(e){return n.validators.hasValue(!1,e)}}),n}return o(t,e),t}(n(911).PrimitiveClaim);t.BooleanClaim=i},748:function(e,t){var n=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}u((r=r.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.PrimitiveArrayClaim=void 0;var o=function(){function e(e){var t=this;this.validators={includes:function(e,o,s){return void 0===o&&(o=t.defaultMaxAgeInSeconds),{id:void 0!==s?s:t.id,refresh:function(e){return t.refresh(e)},shouldRefresh:function(e,n){return void 0===t.getValueFromPayload(e,n)||void 0!==o&&e[t.id].t<Date.now()-1e3*o},validate:function(s,i){return n(t,void 0,void 0,(function(){var t,n;return r(this,(function(r){return void 0===(t=this.getValueFromPayload(s,i))?[2,{isValid:!1,reason:{message:"value does not exist",expectedToInclude:e,actualValue:t}}]:(n=(Date.now()-this.getLastFetchedTime(s,i))/1e3,void 0!==o&&n>o?[2,{isValid:!1,reason:{message:"expired",ageInSeconds:n,maxAgeInSeconds:o}}]:t.includes(e)?[2,{isValid:!0}]:[2,{isValid:!1,reason:{message:"wrong value",expectedToInclude:e,actualValue:t}}])}))}))}}},excludes:function(e,o,s){return void 0===o&&(o=t.defaultMaxAgeInSeconds),{id:void 0!==s?s:t.id,refresh:function(e){return t.refresh(e)},shouldRefresh:function(e,n){return void 0===t.getValueFromPayload(e,n)||void 0!==o&&e[t.id].t<Date.now()-1e3*o},validate:function(s,i){return n(t,void 0,void 0,(function(){var t,n;return r(this,(function(r){return void 0===(t=this.getValueFromPayload(s,i))?[2,{isValid:!1,reason:{message:"value does not exist",expectedToNotInclude:e,actualValue:t}}]:(n=(Date.now()-this.getLastFetchedTime(s,i))/1e3,void 0!==o&&n>o?[2,{isValid:!1,reason:{message:"expired",ageInSeconds:n,maxAgeInSeconds:o}}]:t.includes(e)?[2,{isValid:!1,reason:{message:"wrong value",expectedToNotInclude:e,actualValue:t}}]:[2,{isValid:!0}])}))}))}}},includesAll:function(e,o,s){return void 0===o&&(o=t.defaultMaxAgeInSeconds),{id:void 0!==s?s:t.id,refresh:function(e){return t.refresh(e)},shouldRefresh:function(e,n){return void 0===t.getValueFromPayload(e,n)||void 0!==o&&e[t.id].t<Date.now()-1e3*o},validate:function(s,i){return n(t,void 0,void 0,(function(){var t,n,a,u;return r(this,(function(r){return void 0===(t=this.getValueFromPayload(s,i))?[2,{isValid:!1,reason:{message:"value does not exist",expectedToInclude:e,actualValue:t}}]:(n=(Date.now()-this.getLastFetchedTime(s,i))/1e3,void 0!==o&&n>o?[2,{isValid:!1,reason:{message:"expired",ageInSeconds:n,maxAgeInSeconds:o}}]:(a=new Set(t),[2,(u=e.every((function(e){return a.has(e)})))?{isValid:u}:{isValid:u,reason:{message:"wrong value",expectedToInclude:e,actualValue:t}}]))}))}))}}},includesAny:function(e,o,s){return void 0===o&&(o=t.defaultMaxAgeInSeconds),{id:void 0!==s?s:t.id,refresh:function(e){return t.refresh(e)},shouldRefresh:function(e,n){return void 0===t.getValueFromPayload(e,n)||void 0!==o&&e[t.id].t<Date.now()-1e3*o},validate:function(s,i){return n(t,void 0,void 0,(function(){var t,n,a,u;return r(this,(function(r){return void 0===(t=this.getValueFromPayload(s,i))?[2,{isValid:!1,reason:{message:"value does not exist",expectedToInclude:e,actualValue:t}}]:(n=(Date.now()-this.getLastFetchedTime(s,i))/1e3,void 0!==o&&n>o?[2,{isValid:!1,reason:{message:"expired",ageInSeconds:n,maxAgeInSeconds:o}}]:(a=new Set(t),[2,(u=e.some((function(e){return a.has(e)})))?{isValid:u}:{isValid:u,reason:{message:"wrong value",expectedToIncludeAtLeastOneOf:e,actualValue:t}}]))}))}))}}},excludesAll:function(e,o,s){return void 0===o&&(o=t.defaultMaxAgeInSeconds),{id:void 0!==s?s:t.id,refresh:function(e){return t.refresh(e)},shouldRefresh:function(e,n){return void 0===t.getValueFromPayload(e,n)||void 0!==o&&e[t.id].t<Date.now()-1e3*o},validate:function(s,i){return n(t,void 0,void 0,(function(){var t,n,a,u;return r(this,(function(r){return void 0===(t=this.getValueFromPayload(s,i))?[2,{isValid:!1,reason:{message:"value does not exist",expectedToNotInclude:e,actualValue:t}}]:(n=(Date.now()-this.getLastFetchedTime(s,i))/1e3,void 0!==o&&n>o?[2,{isValid:!1,reason:{message:"expired",ageInSeconds:n,maxAgeInSeconds:o}}]:(a=new Set(t),[2,(u=e.every((function(e){return!a.has(e)})))?{isValid:u}:{isValid:u,reason:{message:"wrong value",expectedToNotInclude:e,actualValue:t}}]))}))}))}}}},this.id=e.id,this.refresh=e.refresh,this.defaultMaxAgeInSeconds=e.defaultMaxAgeInSeconds}return e.prototype.getValueFromPayload=function(e,t){return void 0!==e[this.id]?e[this.id].v:void 0},e.prototype.getLastFetchedTime=function(e,t){return void 0!==e[this.id]?e[this.id].t:void 0},e}();t.PrimitiveArrayClaim=o},911:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PrimitiveClaim=void 0;var n=function(){function e(e){var t=this;this.validators={hasValue:function(e,n,r){return void 0===n&&(n=t.defaultMaxAgeInSeconds),{id:void 0!==r?r:t.id,refresh:function(e){return t.refresh(e)},shouldRefresh:function(e,r){return void 0===t.getValueFromPayload(e,r)||void 0!==n&&e[t.id].t<Date.now()-1e3*n},validate:function(r,o){var s=t.getValueFromPayload(r,o);if(void 0===s)return{isValid:!1,reason:{message:"value does not exist",expectedValue:e,actualValue:s}};var i=(Date.now()-t.getLastFetchedTime(r,o))/1e3;return void 0!==n&&i>n?{isValid:!1,reason:{message:"expired",ageInSeconds:i,maxAgeInSeconds:n}}:s!==e?{isValid:!1,reason:{message:"wrong value",expectedValue:e,actualValue:s}}:{isValid:!0}}}}},this.id=e.id,this.refresh=e.refresh,this.defaultMaxAgeInSeconds=e.defaultMaxAgeInSeconds}return e.prototype.getValueFromPayload=function(e,t){return void 0!==e[this.id]?e[this.id].v:void 0},e.prototype.getLastFetchedTime=function(e,t){return void 0!==e[this.id]?e[this.id].t:void 0},e}();t.PrimitiveClaim=n},173:function(e,t){var n,r=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.STGeneralError=void 0;var o=function(e){function t(t){var n=e.call(this,t)||this;return n.isSuperTokensGeneralError=!0,n}return r(t,e),t.isThisError=function(e){return!0===e.isSuperTokensGeneralError},t}(Error);t.STGeneralError=o},379:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}u((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.setFrontToken=t.getFrontToken=t.setAntiCSRF=t.setIdRefreshToken=t.getIdRefreshToken=t.onInvalidClaimResponse=t.onTokenUpdate=t.onUnauthorisedResponse=t.FrontToken=t.AntiCsrfToken=void 0;var i=n(743),a=n(255),u=n(318),c=n(501),l=n(958),d=n(941),f=n(845),g=function(){function e(){}return e.getToken=function(t){return o(this,void 0,void 0,(function(){var n;return s(this,(function(r){switch(r.label){case 0:return(0,f.logDebugMessage)("AntiCsrfToken.getToken: called"),void 0===t?(e.tokenInfo=void 0,(0,f.logDebugMessage)("AntiCsrfToken.getToken: returning undefined"),[2,void 0]):void 0!==e.tokenInfo?[3,2]:[4,S()];case 1:return null===(n=r.sent())?((0,f.logDebugMessage)("AntiCsrfToken.getToken: returning undefined"),[2,void 0]):(e.tokenInfo={antiCsrf:n,associatedIdRefreshToken:t},[3,4]);case 2:return e.tokenInfo.associatedIdRefreshToken===t?[3,4]:(e.tokenInfo=void 0,[4,e.getToken(t)]);case 3:return[2,r.sent()];case 4:return(0,f.logDebugMessage)("AntiCsrfToken.getToken: returning: "+e.tokenInfo.antiCsrf),[2,e.tokenInfo.antiCsrf]}}))}))},e.removeToken=function(){return o(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return(0,f.logDebugMessage)("AntiCsrfToken.removeToken: called"),e.tokenInfo=void 0,[4,T(void 0)];case 1:return t.sent(),[2]}}))}))},e.setItem=function(t,n){return o(this,void 0,void 0,(function(){return s(this,(function(r){switch(r.label){case 0:return void 0===t?(e.tokenInfo=void 0,[2]):((0,f.logDebugMessage)("AntiCsrfToken.setItem: called"),[4,T(n)]);case 1:return r.sent(),e.tokenInfo={antiCsrf:n,associatedIdRefreshToken:t},[2]}}))}))},e}();t.AntiCsrfToken=g;var h=function(){function e(){}return e.getTokenInfo=function(){return o(this,void 0,void 0,(function(){var t,n;return s(this,(function(r){switch(r.label){case 0:return(0,f.logDebugMessage)("FrontToken.getTokenInfo: called"),[4,E()];case 1:return null!==(t=r.sent())?[3,5]:[4,k(!1)];case 2:return"EXISTS"!==r.sent().status?[3,4]:[4,new Promise((function(t){e.waiters.push(t)}))];case 3:return r.sent(),[2,e.getTokenInfo()];case 4:return[2,void 0];case 5:return n=D(t),(0,f.logDebugMessage)("FrontToken.getTokenInfo: returning ate: "+n.ate),(0,f.logDebugMessage)("FrontToken.getTokenInfo: returning uid: "+n.uid),(0,f.logDebugMessage)("FrontToken.getTokenInfo: returning up: "+n.up),[2,n]}}))}))},e.removeToken=function(){return o(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return(0,f.logDebugMessage)("FrontToken.removeToken: called"),[4,C(void 0)];case 1:return t.sent(),e.waiters.forEach((function(e){return e(void 0)})),e.waiters=[],[2]}}))}))},e.setItem=function(t){return o(this,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return(0,f.logDebugMessage)("FrontToken.setItem: called"),[4,C(t)];case 1:return n.sent(),e.waiters.forEach((function(e){return e(void 0)})),e.waiters=[],[2]}}))}))},e.waiters=[],e}();t.FrontToken=h;var p=function(){function e(){}var t;return e.init=function(t,r){(0,f.logDebugMessage)("init: called"),(0,f.logDebugMessage)("init: Input apiBasePath: "+t.apiBasePath),(0,f.logDebugMessage)("init: Input apiDomain: "+t.apiDomain),(0,f.logDebugMessage)("init: Input autoAddCredentials: "+t.autoAddCredentials),(0,f.logDebugMessage)("init: Input cookieDomain: "+t.cookieDomain),(0,f.logDebugMessage)("init: Input isInIframe: "+t.isInIframe),(0,f.logDebugMessage)("init: Input sessionExpiredStatusCode: "+t.sessionExpiredStatusCode),(0,f.logDebugMessage)("init: Input sessionScope: "+t.sessionScope);var o=l.default.getReferenceOrThrow().windowHandler.getWindowUnsafe();e.env=void 0===o||void 0===o.fetch?n.g:o,e.refreshTokenUrl=t.apiDomain+t.apiBasePath+"/session/refresh",e.signOutUrl=t.apiDomain+t.apiBasePath+"/signout",e.rid="session",e.config=t,void 0===e.env.__supertokensOriginalFetch&&((0,f.logDebugMessage)("init: __supertokensOriginalFetch is undefined"),e.env.__supertokensOriginalFetch=e.env.fetch.bind(e.env),e.env.__supertokensSessionRecipe=r,e.env.fetch=e.env.__supertokensSessionRecipe.addFetchInterceptorsAndReturnModifiedFetch({originalFetch:e.env.__supertokensOriginalFetch,userContext:{}}),e.env.__supertokensSessionRecipe.addXMLHttpRequestInterceptor({userContext:{}})),e.recipeImpl=e.env.__supertokensSessionRecipe,e.initCalled=!0},t=e,e.initCalled=!1,e.doRequest=function(n,a,c){return o(void 0,void 0,void 0,(function(){var o,d,p,v,b,m,y,S,T,x,D;return s(t,(function(t){switch(t.label){case 0:if(!e.initCalled)throw Error("init function not called");(0,f.logDebugMessage)("doRequest: start of fetch interception"),o=!1;try{o="string"==typeof c&&!(0,u.shouldDoInterceptionBasedOnUrl)(c,e.config.apiDomain,e.config.cookieDomain)||void 0!==c&&"string"==typeof c.url&&!(0,u.shouldDoInterceptionBasedOnUrl)(c.url,e.config.apiDomain,e.config.cookieDomain)}catch(t){if("Please provide a valid domain name"!==t.message)throw t;(0,f.logDebugMessage)("doRequest: Trying shouldDoInterceptionBasedOnUrl with location.origin"),o=!(0,u.shouldDoInterceptionBasedOnUrl)(l.default.getReferenceOrThrow().windowHandler.location.getOrigin(),e.config.apiDomain,e.config.cookieDomain)}return(0,f.logDebugMessage)("doRequest: Value of doNotDoInterception: "+o),o?((0,f.logDebugMessage)("doRequest: Returning without interception"),[4,n(a)]):[3,2];case 1:return[2,t.sent()];case 2:(0,f.logDebugMessage)("doRequest: Interception started"),i.ProcessState.getInstance().addState(i.PROCESS_STATE.CALLING_INTERCEPTION_REQUEST),t.label=3;case 3:t.trys.push([3,,22,27]),d=void 0,t.label=4;case 4:return[4,k(!0)];case 5:return p=t.sent(),v=new Headers(void 0!==a&&void 0!==a.headers?a.headers:c.headers),b=r(r({},a),{headers:v}),"EXISTS"!==p.status?[3,7]:[4,g.getToken(p.token)];case 6:void 0!==(T=t.sent())&&((0,f.logDebugMessage)("doRequest: Adding anti-csrf token to request"),v.set("anti-csrf",T)),t.label=7;case 7:return e.config.autoAddCredentials&&((0,f.logDebugMessage)("doRequest: Adding credentials include"),void 0===b?b={credentials:"include"}:void 0===b.credentials&&(b=r(r({},b),{credentials:"include"}))),v.has("rid")?(0,f.logDebugMessage)("doRequest: rid header was already there in request"):((0,f.logDebugMessage)("doRequest: Adding rid header: anti-csrf"),v.set("rid","anti-csrf")),(0,f.logDebugMessage)("doRequest: Making user's http call"),[4,n(b)];case 8:return m=t.sent(),(0,f.logDebugMessage)("doRequest: User's http call ended"),(y=m.headers.get("id-refresh-token"))?((0,f.logDebugMessage)("doRequest: Setting sIRTFrontend: "+y),[4,R(y,m.status)]):[3,10];case 9:t.sent(),t.label=10;case 10:return m.status!==e.config.sessionExpiredStatusCode?[3,12]:((0,f.logDebugMessage)("doRequest: Status code is: "+m.status),[4,I(p)]);case 11:return"RETRY"!==(S=t.sent()).result?((0,f.logDebugMessage)("doRequest: Not retrying original request"),d=void 0!==S.error?S.error:m,[3,21]):((0,f.logDebugMessage)("doRequest: Retrying original request"),[3,20]);case 12:return m.status!==e.config.invalidClaimStatusCode?[3,14]:[4,w(m)];case 13:t.sent(),t.label=14;case 14:return(T=m.headers.get("anti-csrf"))?[4,k(!0)]:[3,17];case 15:return"EXISTS"!==(x=t.sent()).status?[3,17]:((0,f.logDebugMessage)("doRequest: Setting anti-csrf token"),[4,g.setItem(x.token,T)]);case 16:t.sent(),t.label=17;case 17:return(D=m.headers.get("front-token"))?((0,f.logDebugMessage)("doRequest: Setting sFrontToken: "+D),[4,h.setItem(D)]):[3,19];case 18:t.sent(),t.label=19;case 19:return[2,m];case 20:return[3,4];case 21:return[2,d];case 22:return[4,k(!1)];case 23:return"NOT_EXISTS"!==t.sent().status?[3,26]:((0,f.logDebugMessage)("doRequest: sIRTFrontend doesn't exist, so removing anti-csrf and sFrontToken"),[4,g.removeToken()]);case 24:return t.sent(),[4,h.removeToken()];case 25:t.sent(),t.label=26;case 26:return[7];case 27:return[2]}}))}))},e.attemptRefreshingSession=function(){return o(void 0,void 0,void 0,(function(){var n;return s(t,(function(t){switch(t.label){case 0:if(!e.initCalled)throw Error("init function not called");return[4,k(!1)];case 1:return[4,I(t.sent())];case 2:if("API_ERROR"===(n=t.sent()).result)throw n.error;return[2,"RETRY"===n.result]}}))}))},e}();t.default=p;var v="sIRTFrontend",b="sAntiCsrf",m="sFrontToken";function I(e){return o(this,void 0,void 0,(function(){var t,n,o,i,u,c,l,v,b,m,I,y,w;return s(this,(function(s){switch(s.label){case 0:return[4,d.default.getReferenceOrThrow().lockFactory()];case 1:t=s.sent(),s.label=2;case 2:return(0,f.logDebugMessage)("onUnauthorisedResponse: trying to acquire lock"),[4,t.acquireLock("REFRESH_TOKEN_USE",1e3)];case 3:if(!s.sent())return[3,29];(0,f.logDebugMessage)("onUnauthorisedResponse: lock acquired"),s.label=4;case 4:return s.trys.push([4,21,23,29]),[4,k(!1)];case 5:return"NOT_EXISTS"===(n=s.sent()).status?((0,f.logDebugMessage)("onUnauthorisedResponse: Not refreshing because sIRTFrontend is remove"),p.config.onHandleEvent({action:"UNAUTHORISED",sessionExpiredOrRevoked:!1,userContext:{}}),[2,{result:"SESSION_EXPIRED"}]):n.status!==e.status||"EXISTS"===n.status&&"EXISTS"===e.status&&n.token!==e.token?((0,f.logDebugMessage)("onUnauthorisedResponse: Retrying early because pre and post id refresh tokens don't match"),[2,{result:"RETRY"}]):(o={},"EXISTS"!==e.status?[3,7]:[4,g.getToken(e.token)]);case 6:void 0!==(i=s.sent())&&((0,f.logDebugMessage)("onUnauthorisedResponse: Adding anti-csrf token to refresh API call"),o=r(r({},o),{"anti-csrf":i})),s.label=7;case 7:return(0,f.logDebugMessage)("onUnauthorisedResponse: Adding rid and fdi-versions to refresh call header"),o=r(r({rid:p.rid},o),{"fdi-version":a.supported_fdi.join(",")}),(0,f.logDebugMessage)("onUnauthorisedResponse: Calling refresh pre API hook"),[4,p.config.preAPIHook({action:"REFRESH_SESSION",requestInit:{method:"post",credentials:"include",headers:o},url:p.refreshTokenUrl,userContext:{}})];case 8:return u=s.sent(),(0,f.logDebugMessage)("onUnauthorisedResponse: Making refresh call"),[4,p.env.__supertokensOriginalFetch(u.url,u.requestInit)];case 9:return c=s.sent(),(0,f.logDebugMessage)("onUnauthorisedResponse: Refresh call ended"),l=!0,(v=c.headers.get("id-refresh-token"))?((0,f.logDebugMessage)("onUnauthorisedResponse: Setting sIRTFrontend from refresh API call: "+v),[4,R(v,c.status)]):[3,11];case 10:s.sent(),l=!1,s.label=11;case 11:return c.status!==p.config.sessionExpiredStatusCode?[3,13]:((0,f.logDebugMessage)("onUnauthorisedResponse: Refresh status code is: "+c.status),l?[4,R("remove",c.status)]:[3,13]);case 12:s.sent(),s.label=13;case 13:if(c.status>=300)throw c;return[4,p.config.postAPIHook({action:"REFRESH_SESSION",fetchResponse:c.clone(),requestInit:u.requestInit,url:u.url,userContext:{}})];case 14:return s.sent(),[4,k(!1)];case 15:return"NOT_EXISTS"===s.sent().status?((0,f.logDebugMessage)("onUnauthorisedResponse: sIRTFrontend is remove, so returning session expired"),[2,{result:"SESSION_EXPIRED"}]):(b=c.headers.get("anti-csrf"))?[4,k(!0)]:[3,18];case 16:return"EXISTS"!==(m=s.sent()).status?[3,18]:((0,f.logDebugMessage)("onUnauthorisedResponse: setting anti-csrf token"),[4,g.setItem(m.token,b)]);case 17:s.sent(),s.label=18;case 18:return(I=c.headers.get("front-token"))?((0,f.logDebugMessage)("onUnauthorisedResponse: setting sFrontToken: "+I),[4,h.setItem(I)]):[3,20];case 19:s.sent(),s.label=20;case 20:return p.config.onHandleEvent({action:"REFRESH_SESSION",userContext:{}}),(0,f.logDebugMessage)("onUnauthorisedResponse: Sending RETRY signal"),[2,{result:"RETRY"}];case 21:return y=s.sent(),[4,k(!1)];case 22:return"NOT_EXISTS"===s.sent().status?((0,f.logDebugMessage)("onUnauthorisedResponse: sIRTFrontend is remove, so returning session expired"),[2,{result:"SESSION_EXPIRED",error:y}]):((0,f.logDebugMessage)("onUnauthorisedResponse: sending API_ERROR"),[2,{result:"API_ERROR",error:y}]);case 23:return[4,t.releaseLock("REFRESH_TOKEN_USE")];case 24:return s.sent(),(0,f.logDebugMessage)("onUnauthorisedResponse: Released lock"),[4,k(!1)];case 25:return"NOT_EXISTS"!==s.sent().status?[3,28]:((0,f.logDebugMessage)("onUnauthorisedResponse: sIRTFrontend is remove, so removing anti-csrf and sFrontToken"),[4,g.removeToken()]);case 26:return s.sent(),[4,h.removeToken()];case 27:s.sent(),s.label=28;case 28:return[7];case 29:return[4,k(!1)];case 30:return"NOT_EXISTS"===(w=s.sent()).status?((0,f.logDebugMessage)("onUnauthorisedResponse: lock acquired failed and sIRTFrontend is remove, so sending SESSION_EXPIRED"),[2,{result:"SESSION_EXPIRED"}]):w.status!==e.status||"EXISTS"===w.status&&"EXISTS"===e.status&&w.token!==e.token?((0,f.logDebugMessage)("onUnauthorisedResponse: lock acquired failed and retrying early because pre and post id refresh tokens don't match"),[2,{result:"RETRY"}]):[3,2];case 31:return[2]}}))}))}function y(){(0,f.logDebugMessage)("onTokenUpdate: firing ACCESS_TOKEN_PAYLOAD_UPDATED event"),p.config.onHandleEvent({action:"ACCESS_TOKEN_PAYLOAD_UPDATED",userContext:{}})}function w(e){return o(this,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,p.recipeImpl.getInvalidClaimsFromResponse({response:e,userContext:{}})];case 1:return(t=n.sent())&&p.config.onHandleEvent({action:"API_INVALID_CLAIM",claimValidationErrors:t,userContext:{}}),[3,3];case 2:return n.sent(),[3,3];case 3:return[2]}}))}))}function k(e){return o(this,void 0,void 0,(function(){function t(){return o(this,void 0,void 0,(function(){function e(){return o(this,void 0,void 0,(function(){var e,t,n,r;return s(this,(function(o){switch(o.label){case 0:return t="; ",[4,c.default.getReferenceOrThrow().cookieHandler.getCookie()];case 1:if(e=t+o.sent(),(n=e.split("; sIRTFrontend=")).length>=2){if("remove"===(r=n.pop()))return[2,"remove"];if(void 0!==r)return[2,r.split(";").shift()]}return[2,void 0]}}))}))}return s(this,(function(t){switch(t.label){case 0:return[4,e()];case 1:return[2,t.sent()]}}))}))}var n,r;return s(this,(function(o){switch(o.label){case 0:return(0,f.logDebugMessage)("getIdRefreshToken: called"),[4,t()];case 1:return"remove"===(n=o.sent())?((0,f.logDebugMessage)("getIdRefreshToken: is removed"),[2,{status:"NOT_EXISTS"}]):void 0!==n?[3,5]:((0,f.logDebugMessage)("getIdRefreshToken: is undefined"),r={status:"MAY_EXIST"},e?((0,f.logDebugMessage)("getIdRefreshToken: trying to refresg"),[4,I(r)]):[3,4]);case 2:return"RETRY"!==o.sent().result?((0,f.logDebugMessage)("getIdRefreshToken: false NOT_EXISTS in case error from backend"),[2,{status:"NOT_EXISTS"}]):((0,f.logDebugMessage)("getIdRefreshToken: Retrying post refresh"),[4,k(e)]);case 3:return[2,o.sent()];case 4:return(0,f.logDebugMessage)("getIdRefreshToken: returning: "+r.status),[2,r];case 5:return(0,f.logDebugMessage)("getIdRefreshToken: returning EXISTS: "+n),[2,{status:"EXISTS",token:n}]}}))}))}function R(e,t){return o(this,void 0,void 0,(function(){function n(e,t){return o(this,void 0,void 0,(function(){var n,r,o;return s(this,(function(s){switch(s.label){case 0:return n="Fri, 31 Dec 9999 23:59:59 GMT",r="remove","remove"!==e&&(o=e.split(";"),r=o[0],n=new Date(Number(o[1])).toUTCString()),"localhost"!==t&&t!==l.default.getReferenceOrThrow().windowHandler.location.getHostName()?[3,2]:[4,c.default.getReferenceOrThrow().cookieHandler.setCookie("".concat(v,"=").concat(r,";expires=").concat(n,";path=/;samesite=").concat(p.config.isInIframe?"none;secure":"lax"))];case 1:return s.sent(),[3,4];case 2:return[4,c.default.getReferenceOrThrow().cookieHandler.setCookie("".concat(v,"=").concat(r,";expires=").concat(n,";domain=").concat(t,";path=/;samesite=").concat(p.config.isInIframe?"none;secure":"lax"))];case 3:s.sent(),s.label=4;case 4:return[2]}}))}))}var r;return s(this,(function(o){switch(o.label){case 0:return(0,f.logDebugMessage)("setIdRefreshToken: called"),[4,k(!1)];case 1:return r=o.sent().status,(0,f.logDebugMessage)("setIdRefreshToken: setting: "+e),[4,n(e,p.config.sessionScope)];case 2:return o.sent(),"remove"===e&&"EXISTS"===r&&(t===p.config.sessionExpiredStatusCode?((0,f.logDebugMessage)("setIdRefreshToken: firing UNAUTHORISED event"),p.config.onHandleEvent({action:"UNAUTHORISED",sessionExpiredOrRevoked:!0,userContext:{}})):((0,f.logDebugMessage)("setIdRefreshToken: firing SIGN_OUT event"),p.config.onHandleEvent({action:"SIGN_OUT",userContext:{}}))),"remove"!==e&&"NOT_EXISTS"===r&&((0,f.logDebugMessage)("setIdRefreshToken: firing SESSION_CREATED event"),p.config.onHandleEvent({action:"SESSION_CREATED",userContext:{}})),[2]}}))}))}function S(){return o(this,void 0,void 0,(function(){function e(){return o(this,void 0,void 0,(function(){var e,t,n,r,o;return s(this,(function(s){switch(s.label){case 0:return t="; ",[4,c.default.getReferenceOrThrow().cookieHandler.getCookie()];case 1:return e=t+s.sent(),(n=e.split("; sAntiCsrf=")).length>=2&&void 0!==(r=n.pop())?void 0===(o=r.split(";").shift())?[2,null]:[2,o]:[2,null]}}))}))}var t;return s(this,(function(n){switch(n.label){case 0:return(0,f.logDebugMessage)("getAntiCSRFToken: called"),[4,k(!0)];case 1:return"EXISTS"!==n.sent().status?((0,f.logDebugMessage)("getAntiCSRFToken: Returning because sIRTFrontend != EXISTS"),[2,null]):[4,e()];case 2:return t=n.sent(),(0,f.logDebugMessage)("getAntiCSRFToken: returning: "+t),[2,t]}}))}))}function T(e){return o(this,void 0,void 0,(function(){function t(e,t){return o(this,void 0,void 0,(function(){var n,r;return s(this,(function(o){switch(o.label){case 0:return n="Thu, 01 Jan 1970 00:00:01 GMT",r="",void 0!==e&&(r=e,n=void 0),"localhost"!==t&&t!==l.default.getReferenceOrThrow().windowHandler.location.getHostName()?[3,5]:void 0===n?[3,2]:[4,c.default.getReferenceOrThrow().cookieHandler.setCookie("".concat(b,"=").concat(r,";expires=").concat(n,";path=/;samesite=").concat(p.config.isInIframe?"none;secure":"lax"))];case 1:return o.sent(),[3,4];case 2:return[4,c.default.getReferenceOrThrow().cookieHandler.setCookie("".concat(b,"=").concat(r,";expires=Fri, 31 Dec 9999 23:59:59 GMT;path=/;samesite=").concat(p.config.isInIframe?"none;secure":"lax"))];case 3:o.sent(),o.label=4;case 4:return[3,9];case 5:return void 0===n?[3,7]:[4,c.default.getReferenceOrThrow().cookieHandler.setCookie("".concat(b,"=").concat(r,";expires=").concat(n,";domain=").concat(t,";path=/;samesite=").concat(p.config.isInIframe?"none;secure":"lax"))];case 6:return o.sent(),[3,9];case 7:return[4,c.default.getReferenceOrThrow().cookieHandler.setCookie("".concat(b,"=").concat(r,";domain=").concat(t,";expires=Fri, 31 Dec 9999 23:59:59 GMT;path=/;samesite=").concat(p.config.isInIframe?"none;secure":"lax"))];case 8:o.sent(),o.label=9;case 9:return[2]}}))}))}return s(this,(function(n){switch(n.label){case 0:return(0,f.logDebugMessage)("setAntiCSRF: called: "+e),[4,t(e,p.config.sessionScope)];case 1:return n.sent(),[2]}}))}))}function x(){return o(this,void 0,void 0,(function(){var e,t,n,r,o;return s(this,(function(s){switch(s.label){case 0:return(0,f.logDebugMessage)("getFrontTokenFromCookie: called"),t="; ",[4,c.default.getReferenceOrThrow().cookieHandler.getCookie()];case 1:return e=t+s.sent(),(n=e.split("; sFrontToken=")).length>=2&&void 0!==(r=n.pop())?void 0===(o=r.split(";").shift())?[2,null]:[2,o]:[2,null]}}))}))}function D(e){return JSON.parse(decodeURIComponent(escape(atob(e))))}function E(){return o(this,void 0,void 0,(function(){var e;return s(this,(function(t){switch(t.label){case 0:return(0,f.logDebugMessage)("getFrontToken: called"),[4,k(!0)];case 1:return"EXISTS"!==t.sent().status?((0,f.logDebugMessage)("getFrontToken: Returning because sIRTFrontend != EXISTS"),[2,null]):[4,x()];case 2:return e=t.sent(),(0,f.logDebugMessage)("getFrontToken: returning: "+e),[2,e]}}))}))}function C(e){return o(this,void 0,void 0,(function(){function t(e,t){return o(this,void 0,void 0,(function(){var n,r;return s(this,(function(o){switch(o.label){case 0:return n="Thu, 01 Jan 1970 00:00:01 GMT",r="",void 0!==e&&(r=e,n=void 0),"localhost"!==t&&t!==l.default.getReferenceOrThrow().windowHandler.location.getHostName()?[3,5]:void 0===n?[3,2]:[4,c.default.getReferenceOrThrow().cookieHandler.setCookie("".concat(m,"=").concat(r,";expires=").concat(n,";path=/;samesite=").concat(p.config.isInIframe?"none;secure":"lax"))];case 1:return o.sent(),[3,4];case 2:return[4,c.default.getReferenceOrThrow().cookieHandler.setCookie("".concat(m,"=").concat(r,";expires=Fri, 31 Dec 9999 23:59:59 GMT;path=/;samesite=").concat(p.config.isInIframe?"none;secure":"lax"))];case 3:o.sent(),o.label=4;case 4:return[3,9];case 5:return void 0===n?[3,7]:[4,c.default.getReferenceOrThrow().cookieHandler.setCookie("".concat(m,"=").concat(r,";expires=").concat(n,";domain=").concat(t,";path=/;samesite=").concat(p.config.isInIframe?"none;secure":"lax"))];case 6:return o.sent(),[3,9];case 7:return[4,c.default.getReferenceOrThrow().cookieHandler.setCookie("".concat(m,"=").concat(r,";domain=").concat(t,";expires=Fri, 31 Dec 9999 23:59:59 GMT;path=/;samesite=").concat(p.config.isInIframe?"none;secure":"lax"))];case 8:o.sent(),o.label=9;case 9:return[2]}}))}))}var n,r,i;return s(this,(function(o){switch(o.label){case 0:return(0,f.logDebugMessage)("setFrontToken: called"),[4,x()];case 1:return null!==(n=o.sent())&&void 0!==e&&(r=D(n).up,i=D(e).up,JSON.stringify(r)!==JSON.stringify(i)&&y()),[4,t(e,p.config.sessionScope)];case 2:return o.sent(),[2]}}))}))}t.onUnauthorisedResponse=I,t.onTokenUpdate=y,t.onInvalidClaimResponse=w,t.getIdRefreshToken=k,t.setIdRefreshToken=R,t.setAntiCSRF=T,t.getFrontToken=E,t.setFrontToken=C},569:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.BooleanClaim=t.PrimitiveArrayClaim=t.PrimitiveClaim=t.SessionClaimValidator=t.getInvalidClaimsFromResponse=t.getClaimValue=t.validateClaims=t.signOut=t.addAxiosInterceptors=t.doesSessionExist=t.attemptRefreshingSession=t.getAccessTokenPayloadSecurely=t.getUserId=t.init=void 0;var s=n(379),i=n(994),a=n(333),u=n(318),c=n(501),l=n(958),d=n(941),f=n(153),g=function(){function e(){}var t;return e.init=function(t){c.default.init(t.cookieHandler),l.default.init(t.windowHandler),d.default.init(t.lockFactory);var n=(0,u.validateAndNormaliseInputOrThrowError)(t),r=new a.default((0,i.default)({onHandleEvent:n.onHandleEvent,preAPIHook:n.preAPIHook,postAPIHook:n.postAPIHook,sessionExpiredStatusCode:n.sessionExpiredStatusCode})).override(n.override.functions).build();s.default.init(n,r),e.axiosInterceptorQueue.forEach((function(e){e()})),e.axiosInterceptorQueue=[]},e.getUserId=function(e){return s.default.recipeImpl.getUserId({userContext:(0,u.getNormalisedUserContext)(void 0===e?void 0:e.userContext)})},e.getAccessTokenPayloadSecurely=function(e){return r(this,void 0,void 0,(function(){return o(this,(function(t){return[2,s.default.recipeImpl.getAccessTokenPayloadSecurely({userContext:(0,u.getNormalisedUserContext)(void 0===e?void 0:e.userContext)})]}))}))},t=e,e.axiosInterceptorQueue=[],e.attemptRefreshingSession=function(){return r(void 0,void 0,void 0,(function(){return o(t,(function(e){return[2,s.default.attemptRefreshingSession()]}))}))},e.doesSessionExist=function(e){return s.default.recipeImpl.doesSessionExist({userContext:(0,u.getNormalisedUserContext)(void 0===e?void 0:e.userContext)})},e.addAxiosInterceptors=function(t,n){s.default.initCalled?s.default.recipeImpl.addAxiosInterceptors({axiosInstance:t,userContext:(0,u.getNormalisedUserContext)(n)}):e.axiosInterceptorQueue.push((function(){s.default.recipeImpl.addAxiosInterceptors({axiosInstance:t,userContext:(0,u.getNormalisedUserContext)(n)})}))},e.signOut=function(e){return s.default.recipeImpl.signOut({userContext:(0,u.getNormalisedUserContext)(void 0===e?void 0:e.userContext)})},e.getInvalidClaimsFromResponse=function(e){return r(this,void 0,void 0,(function(){return o(this,(function(t){return[2,s.default.recipeImpl.getInvalidClaimsFromResponse({response:e.response,userContext:(0,u.getNormalisedUserContext)(e.userContext)})]}))}))},e.getClaimValue=function(t){return r(this,void 0,void 0,(function(){var n,r;return o(this,(function(o){switch(o.label){case 0:return n=(0,u.getNormalisedUserContext)(void 0===t?void 0:t.userContext),[4,e.getAccessTokenPayloadSecurely({userContext:n})];case 1:return r=o.sent(),[2,t.claim.getValueFromPayload(r,n)]}}))}))},e.validateClaims=function(e,t){var n=(0,u.getNormalisedUserContext)(t),r=f.SessionClaimValidatorStore.getClaimValidatorsAddedByOtherRecipes(),o=s.default.recipeImpl.getGlobalClaimValidators({claimValidatorsAddedByOtherRecipes:r,userContext:n}),i=void 0!==e?e(o,n):o;return 0===i.length?[]:s.default.recipeImpl.validateClaims({claimValidators:i,userContext:(0,u.getNormalisedUserContext)(t)})},e}();t.default=g,t.init=g.init,t.getUserId=g.getUserId,t.getAccessTokenPayloadSecurely=g.getAccessTokenPayloadSecurely,t.attemptRefreshingSession=g.attemptRefreshingSession,t.doesSessionExist=g.doesSessionExist,t.addAxiosInterceptors=g.addAxiosInterceptors,t.signOut=g.signOut,t.validateClaims=g.validateClaims,t.getClaimValue=g.getClaimValue,t.getInvalidClaimsFromResponse=g.getInvalidClaimsFromResponse;var h=n(575);Object.defineProperty(t,"SessionClaimValidator",{enumerable:!0,get:function(){return h.SessionClaimValidator}});var p=n(911);Object.defineProperty(t,"PrimitiveClaim",{enumerable:!0,get:function(){return p.PrimitiveClaim}});var v=n(748);Object.defineProperty(t,"PrimitiveArrayClaim",{enumerable:!0,get:function(){return v.PrimitiveArrayClaim}});var b=n(491);Object.defineProperty(t,"BooleanClaim",{enumerable:!0,get:function(){return b.BooleanClaim}})},845:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.logDebugMessage=t.disableLogging=t.enableLogging=void 0;var r=n(255),o=!1;t.enableLogging=function(){o=!0},t.disableLogging=function(){o=!1},t.logDebugMessage=function(e){o&&console.log("".concat("com.supertokens",' {t: "').concat((new Date).toISOString(),'", message: "').concat(e,'", supertokens-website-ver: "').concat(r.package_version,'"}'))}},992:(e,t)=>{function n(e){return/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.isAnIpAddress=void 0,t.isAnIpAddress=n;function r(e,t){void 0===t&&(t=!1),e=e.trim();try{if(!e.startsWith("http://")&&!e.startsWith("https://"))throw new Error("converting to proper URL");var o=new URL(e);return t?o.hostname.startsWith("localhost")||n(o.hostname)?"http://"+o.host:"https://"+o.host:o.protocol+"//"+o.host}catch(e){}if(e.startsWith("/"))throw new Error("Please provide a valid domain name");if(0===e.indexOf(".")&&(e=e.substr(1)),(-1!==e.indexOf(".")||e.startsWith("localhost"))&&!e.startsWith("http://")&&!e.startsWith("https://")){e="https://"+e;try{return new URL(e),r(e,!0)}catch(e){}}throw new Error("Please provide a valid domain name")}t.default=function(e){var t=this;this.getAsStringDangerous=function(){return t.value},this.value=r(e)}},260:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});function n(e){e=e.trim();try{if(!e.startsWith("http://")&&!e.startsWith("https://"))throw new Error("converting to proper URL");return"/"===(e=new URL(e).pathname).charAt(e.length-1)?e.substr(0,e.length-1):e}catch(e){}if((function(e){if(-1===e.indexOf(".")||e.startsWith("/"))return!1;try{return-1!==new URL(e).hostname.indexOf(".")}catch(e){}try{return-1!==new URL("http://"+e).hostname.indexOf(".")}catch(e){}return!1}(e)||e.startsWith("localhost"))&&!e.startsWith("http://")&&!e.startsWith("https://"))return n(e="http://"+e);"/"!==e.charAt(0)&&(e="/"+e);try{return new URL("http://example.com"+e),n("http://example.com"+e)}catch(e){throw new Error("Please provide a valid URL path")}}t.default=function e(t){var r=this;this.startsWith=function(e){return r.value.startsWith(e.value)},this.appendPath=function(t){return new e(r.value+t.value)},this.getAsStringDangerous=function(){return r.value},this.value=n(t)}},743:function(e,t){var n,r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.ProcessState=t.PROCESS_STATE=void 0,(n=t.PROCESS_STATE||(t.PROCESS_STATE={}))[n.CALLING_INTERCEPTION_REQUEST=0]="CALLING_INTERCEPTION_REQUEST",n[n.CALLING_INTERCEPTION_RESPONSE=1]="CALLING_INTERCEPTION_RESPONSE";var s=function(){function e(){var e=this;this.history=[],this.addState=function(t){try{void 0!==process&&void 0!==process.env&&"testing"===process.env.TEST_MODE&&e.history.push(t)}catch(e){}},this.getEventByLastEventByName=function(t){for(var n=e.history.length-1;n>=0;n--)if(e.history[n]==t)return e.history[n]},this.reset=function(){e.history=[]},this.waitForEvent=function(t,n){return void 0===n&&(n=7e3),r(e,void 0,void 0,(function(){var e,r=this;return o(this,(function(o){return e=Date.now(),[2,new Promise((function(o){var s=r;!function r(){var i=s.getEventByLastEventByName(t);void 0===i?Date.now()-e>n?o(void 0):setTimeout(r,1e3):o(i)}()}))]}))}))}}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e}();t.ProcessState=s},994:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}u((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(379),a=n(759),u=n(255),c=n(845),l=n(173),d=n(648);t.default=function(e){return{addXMLHttpRequestInterceptor:function(e){(0,c.logDebugMessage)("addXMLHttpRequestInterceptorAndReturnModified: called"),(0,d.addInterceptorsToXMLHttpRequest)()},addFetchInterceptorsAndReturnModifiedFetch:function(e){return(0,c.logDebugMessage)("addFetchInterceptorsAndReturnModifiedFetch: called"),function(t,n){return o(this,void 0,void 0,(function(){return s(this,(function(o){switch(o.label){case 0:return[4,i.default.doRequest((function(n){return e.originalFetch("string"==typeof t?t:t.clone(),r({},n))}),n,t)];case 1:return[2,o.sent()]}}))}))}},addAxiosInterceptors:function(e){(0,c.logDebugMessage)("addAxiosInterceptors: called");for(var t=e.axiosInstance.interceptors.request,n=0;n<t.handlers.length;n++)if(t.handlers[n].fulfilled===a.interceptorFunctionRequestFulfilled)return void(0,c.logDebugMessage)("addAxiosInterceptors: not adding because already added on this instance");e.axiosInstance.interceptors.request.use(a.interceptorFunctionRequestFulfilled,(function(e){return o(this,void 0,void 0,(function(){return s(this,(function(t){throw e}))}))})),e.axiosInstance.interceptors.response.use((0,a.responseInterceptor)(e.axiosInstance),(0,a.responseErrorInterceptor)(e.axiosInstance))},getUserId:function(e){return o(this,void 0,void 0,(function(){var e;return s(this,(function(t){switch(t.label){case 0:return(0,c.logDebugMessage)("getUserId: called"),[4,i.FrontToken.getTokenInfo()];case 1:if(void 0===(e=t.sent()))throw new Error("No session exists");return(0,c.logDebugMessage)("getUserId: returning: "+e.uid),[2,e.uid]}}))}))},getAccessTokenPayloadSecurely:function(e){return o(this,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:return(0,c.logDebugMessage)("getAccessTokenPayloadSecurely: called"),[4,i.FrontToken.getTokenInfo()];case 1:if(void 0===(t=n.sent()))throw new Error("No session exists");return t.ate<Date.now()?((0,c.logDebugMessage)("getAccessTokenPayloadSecurely: access token expired. Refreshing session"),[4,i.default.attemptRefreshingSession()]):[3,5];case 2:return n.sent()?[4,this.getAccessTokenPayloadSecurely({userContext:e.userContext})]:[3,4];case 3:return[2,n.sent()];case 4:throw new Error("Could not refresh session");case 5:return(0,c.logDebugMessage)("getAccessTokenPayloadSecurely: returning: "+JSON.stringify(t.up)),[2,t.up]}}))}))},doesSessionExist:function(e){return o(this,void 0,void 0,(function(){var e,t;return s(this,(function(n){switch(n.label){case 0:return(0,c.logDebugMessage)("doesSessionExist: called"),[4,i.FrontToken.getTokenInfo()];case 1:return void 0===(e=n.sent())?((0,c.logDebugMessage)("doesSessionExist: access token does not exist locally"),[2,!1]):e.ate<Date.now()?((0,c.logDebugMessage)("doesSessionExist: access token expired. Refreshing session"),[4,(0,i.getIdRefreshToken)(!1)]):[3,4];case 2:return t=n.sent(),[4,(0,i.onUnauthorisedResponse)(t)];case 3:return[2,"RETRY"===n.sent().result];case 4:return[2,!0]}}))}))},signOut:function(t){return o(this,void 0,void 0,(function(){var n,r,o,a;return s(this,(function(s){switch(s.label){case 0:return(0,c.logDebugMessage)("signOut: called"),[4,this.doesSessionExist(t)];case 1:return s.sent()?((0,c.logDebugMessage)("signOut: Calling refresh pre API hook"),[4,e.preAPIHook({action:"SIGN_OUT",requestInit:{method:"post",headers:{"fdi-version":u.supported_fdi.join(","),rid:i.default.rid}},url:i.default.signOutUrl,userContext:t.userContext})]):((0,c.logDebugMessage)("signOut: existing early because session does not exist"),(0,c.logDebugMessage)("signOut: firing SIGN_OUT event"),e.onHandleEvent({action:"SIGN_OUT",userContext:t.userContext}),[2]);case 2:return n=s.sent(),(0,c.logDebugMessage)("signOut: Calling API"),[4,fetch(n.url,n.requestInit)];case 3:if(r=s.sent(),(0,c.logDebugMessage)("signOut: API ended"),(0,c.logDebugMessage)("signOut: API responded with status code: "+r.status),r.status===e.sessionExpiredStatusCode)return[2];if(r.status>=300)throw r;return[4,e.postAPIHook({action:"SIGN_OUT",requestInit:n.requestInit,url:n.url,fetchResponse:r.clone(),userContext:t.userContext})];case 4:return s.sent(),[4,r.clone().json()];case 5:if("GENERAL_ERROR"===(o=s.sent()).status)throw(0,c.logDebugMessage)("doRequest: Throwing general error"),a=void 0===o.message?"No Error Message Provided":o.message,new l.STGeneralError(a);return[2]}}))}))},getInvalidClaimsFromResponse:function(e){return o(this,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:return"body"in e.response?[4,e.response.clone().json()]:[3,2];case 1:return t=n.sent(),[3,3];case 2:t="string"==typeof e.response.data?JSON.parse(e.response.data):e.response.data,n.label=3;case 3:return[2,t.claimValidationErrors]}}))}))},getGlobalClaimValidators:function(e){return e.claimValidatorsAddedByOtherRecipes},validateClaims:function(e){return o(this,void 0,void 0,(function(){var t,n,r,o,i,a,u,c,l;return s(this,(function(s){switch(s.label){case 0:return[4,this.getAccessTokenPayloadSecurely({userContext:e.userContext})];case 1:t=s.sent(),n=0,r=e.claimValidators,s.label=2;case 2:return n<r.length?[4,(c=r[n]).shouldRefresh(t,e.userContext)]:[3,10];case 3:if(!s.sent())return[3,9];s.label=4;case 4:return s.trys.push([4,6,,7]),[4,c.refresh(e.userContext)];case 5:return s.sent(),[3,7];case 6:return o=s.sent(),console.error("Encountered an error while refreshing validator ".concat(c.id),o),[3,7];case 7:return[4,this.getAccessTokenPayloadSecurely({userContext:e.userContext})];case 8:t=s.sent(),s.label=9;case 9:return n++,[3,2];case 10:i=[],a=0,u=e.claimValidators,s.label=11;case 11:return a<u.length?[4,(c=u[a]).validate(t,e.userContext)]:[3,14];case 12:(l=s.sent()).isValid||i.push({validatorId:c.id,reason:l.reason}),s.label=13;case 13:return a++,[3,11];case 14:return[2,i]}}))}))}}}},575:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SessionClaimValidator=void 0;t.SessionClaimValidator=function(e){this.id=e}},272:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.defaultCookieHandlerImplementation=void 0;var s=n(958);t.defaultCookieHandlerImplementation={getCookie:function(){return r(this,void 0,void 0,(function(){return o(this,(function(e){return[2,s.default.getReferenceOrThrow().windowHandler.getWindowUnsafe().document.cookie]}))}))},setCookie:function(e){return r(this,void 0,void 0,(function(){return o(this,(function(t){return s.default.getReferenceOrThrow().windowHandler.getWindowUnsafe().document.cookie=e,[2]}))}))}}},501:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CookieHandlerReference=void 0;var r=n(272),o=function(){function e(e){var t=function(e){return e};void 0!==e&&(t=e),this.cookieHandler=t(r.defaultCookieHandlerImplementation)}return e.init=function(t){void 0===e.instance&&(e.instance=new e(t))},e.getReferenceOrThrow=function(){if(void 0===e.instance)throw new Error("SuperTokensCookieHandler must be initialized before calling this method.");return e.instance},e}();t.CookieHandlerReference=o,t.default=o},318:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}u((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.getNormalisedUserContext=t.shouldDoInterceptionBasedOnUrl=t.validateAndNormaliseInputOrThrowError=t.normaliseSessionScopeOrThrowError=t.normaliseURLPathOrThrowError=t.normaliseURLDomainOrThrowError=void 0;var i=n(992),a=n(260),u=n(958),c=n(845);function l(e){return new i.default(e).getAsStringDangerous()}function d(e){return new a.default(e).getAsStringDangerous()}function f(e){var t=function(e){(e=e.trim().toLowerCase()).startsWith(".")&&(e=e.substr(1)),e.startsWith("http://")||e.startsWith("https://")||(e="http://"+e);try{return(e=new URL(e).hostname).startsWith(".")&&(e=e.substr(1)),e}catch(e){throw new Error("Please provide a valid sessionScope")}}(e);return"localhost"===t||(0,i.isAnIpAddress)(t)?t:e.startsWith(".")?"."+t:t}t.normaliseURLDomainOrThrowError=l,t.normaliseURLPathOrThrowError=d,t.normaliseSessionScopeOrThrowError=f,t.validateAndNormaliseInputOrThrowError=function(e){var t=this,n=l(e.apiDomain),i=d("/auth");void 0!==e.apiBasePath&&(i=d(e.apiBasePath));var a=u.default.getReferenceOrThrow().windowHandler.location.getHostName(),g=f(void 0!==e&&void 0!==e.sessionScope?e.sessionScope:a),h=401;void 0!==e.sessionExpiredStatusCode&&(h=e.sessionExpiredStatusCode);var p=403;if(void 0!==e.invalidClaimStatusCode&&(p=e.invalidClaimStatusCode),h===p)throw new Error("sessionExpiredStatusCode and invalidClaimStatusCode cannot be the same.");var v=!0;void 0!==e.autoAddCredentials&&(v=e.autoAddCredentials);var b=!1;void 0!==e.isInIframe&&(b=e.isInIframe);var m=void 0;void 0!==e.cookieDomain&&(m=f(e.cookieDomain));var I=function(e){return o(t,void 0,void 0,(function(){return s(this,(function(t){return[2,{url:e.url,requestInit:e.requestInit}]}))}))};void 0!==e.preAPIHook&&(I=e.preAPIHook);var y=function(){return o(t,void 0,void 0,(function(){return s(this,(function(e){return[2]}))}))};void 0!==e.postAPIHook&&(y=e.postAPIHook);var w=function(){};void 0!==e.onHandleEvent&&(w=e.onHandleEvent);var k=r({functions:function(e){return e}},e.override);return void 0!==e.enableDebugLogs&&e.enableDebugLogs&&(0,c.enableLogging)(),{apiDomain:n,apiBasePath:i,sessionScope:g,sessionExpiredStatusCode:h,invalidClaimStatusCode:p,autoAddCredentials:v,isInIframe:b,cookieDomain:m,preAPIHook:I,postAPIHook:y,onHandleEvent:w,override:k}},t.shouldDoInterceptionBasedOnUrl=function(e,t,n){if((0,c.logDebugMessage)("shouldDoInterceptionBasedOnUrl: toCheckUrl: "+e+" apiDomain: "+t+" cookiDomain: "+n),e.includes("superTokensDoNotDoInterception"))return!1;e=l(e);var r=new URL(e),o=r.hostname;if(void 0===n){o=""===r.port?o:o+":"+r.port,t=l(t);var s=new URL(t);return o===(""===s.port?s.hostname:s.hostname+":"+s.port)}var i,a=f(n);if(n.split(":").length>1){var u=n.split(":")[n.split(":").length-1];"string"!=typeof(i=u)||isNaN(i)||isNaN(parseFloat(i))||(a+=":"+u,o=""===r.port?o:o+":"+r.port)}return n.startsWith(".")?("."+o).endsWith(a):o===a},t.getNormalisedUserContext=function(e){return void 0===e?{}:e}},941:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LockFactoryReference=void 0;var r=n(895),o=function(){return Promise.resolve(new r.default)},s=function(){function e(e){this.lockFactory=e}return e.init=function(t){void 0===this.instance&&(this.instance=new e(null!=t?t:o))},e.getReferenceOrThrow=function(){if(void 0===e.instance)throw new Error("SuperTokensLockReference must be initialized before calling this method.");return e.instance},e}();t.LockFactoryReference=s,t.default=s},153:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SessionClaimValidatorStore=void 0;var n=function(){function e(){}return e.claimValidatorsAddedByOtherRecipes=[],e.addClaimValidatorFromOtherRecipe=function(t){e.claimValidatorsAddedByOtherRecipes.push(t)},e.getClaimValidatorsAddedByOtherRecipes=function(){return e.claimValidatorsAddedByOtherRecipes},e}();t.SessionClaimValidatorStore=n,t.default=n},586:function(e,t){var n=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}u((r=r.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};function o(){if("undefined"==typeof window)throw Error("If you are using this package with server-side rendering, please make sure that you are checking if the window object is defined.");return window}Object.defineProperty(t,"__esModule",{value:!0}),t.defaultWindowHandlerImplementation=void 0;var s={key:function(e){return n(this,void 0,void 0,(function(){return r(this,(function(t){return[2,o().localStorage.key(e)]}))}))},clear:function(){return n(this,void 0,void 0,(function(){return r(this,(function(e){return[2,o().localStorage.clear()]}))}))},getItem:function(e){return n(this,void 0,void 0,(function(){return r(this,(function(t){return[2,o().localStorage.getItem(e)]}))}))},removeItem:function(e){return n(this,void 0,void 0,(function(){return r(this,(function(t){return[2,o().localStorage.removeItem(e)]}))}))},setItem:function(e,t){return n(this,void 0,void 0,(function(){return r(this,(function(n){return[2,o().localStorage.setItem(e,t)]}))}))},keySync:function(e){return o().localStorage.key(e)},clearSync:function(){return o().localStorage.clear()},getItemSync:function(e){return o().localStorage.getItem(e)},removeItemSync:function(e){return o().localStorage.removeItem(e)},setItemSync:function(e,t){return o().localStorage.setItem(e,t)}},i={key:function(e){return n(this,void 0,void 0,(function(){return r(this,(function(t){return[2,o().sessionStorage.key(e)]}))}))},clear:function(){return n(this,void 0,void 0,(function(){return r(this,(function(e){return[2,o().sessionStorage.clear()]}))}))},getItem:function(e){return n(this,void 0,void 0,(function(){return r(this,(function(t){return[2,o().sessionStorage.getItem(e)]}))}))},removeItem:function(e){return n(this,void 0,void 0,(function(){return r(this,(function(t){return[2,o().sessionStorage.removeItem(e)]}))}))},setItem:function(e,t){return n(this,void 0,void 0,(function(){return r(this,(function(n){return[2,o().sessionStorage.setItem(e,t)]}))}))},keySync:function(e){return o().sessionStorage.key(e)},clearSync:function(){return o().sessionStorage.clear()},getItemSync:function(e){return o().sessionStorage.getItem(e)},removeItemSync:function(e){return o().sessionStorage.removeItem(e)},setItemSync:function(e,t){return o().sessionStorage.setItem(e,t)}};t.defaultWindowHandlerImplementation={history:{replaceState:function(e,t,n){return o().history.replaceState(e,t,n)},getState:function(){return o().history.state}},location:{getHref:function(){return o().location.href},setHref:function(e){o().location.href=e},getSearch:function(){return o().location.search},getHash:function(){return o().location.hash},getPathName:function(){return o().location.pathname},assign:function(e){o().location.assign(e)},getHostName:function(){return o().location.hostname},getHost:function(){return o().location.host},getOrigin:function(){return o().location.origin}},getDocument:function(){return o().document},getWindowUnsafe:function(){return o().window},localStorage:s,sessionStorage:i}},958:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WindowHandlerReference=void 0;var r=n(586),o=function(){function e(e){var t=function(e){return e};void 0!==e&&(t=e),this.windowHandler=t(r.defaultWindowHandlerImplementation)}return e.init=function(t){void 0===e.instance&&(e.instance=new e(t))},e.getReferenceOrThrow=function(){if(void 0===e.instance)throw new Error("SuperTokensWindowHandler must be initialized before calling this method.");return e.instance},e}();t.WindowHandlerReference=o,t.default=o},255:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.supported_fdi=t.package_version=void 0,t.package_version="15.0.0",t.supported_fdi=["1.8","1.9","1.10","1.11","1.12","1.13","1.14","1.15"]},648:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.addInterceptorsToXMLHttpRequest=void 0;var s=n(318),i=n(379),a=n(845),u=n(958),c=n(743),l=["readystatechange","abort","error","load","loadend","loadstart","progress","timeout"];function d(e){return r(this,void 0,void 0,(function(){var t,n,r,s,i;return o(this,(function(o){switch(o.label){case 0:if(t=e.headers.get("content-type"),n="",r="text",null!==t)return[3,5];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,e.text()];case 2:return n=o.sent(),[3,4];case 3:return o.sent(),n="",[3,4];case 4:return[3,9];case 5:return t.includes("application/json")?(r="json",i=(s=JSON).stringify,[4,e.json()]):[3,7];case 6:return n=i.apply(s,[o.sent()]),[3,9];case 7:return t.includes("text/")?[4,e.text()]:[3,9];case 8:n=o.sent(),o.label=9;case 9:return[2,{status:e.status,responseText:n,statusText:e.statusText,responseType:r,headers:e.headers}]}}))}))}t.addInterceptorsToXMLHttpRequest=function(){var e=!1;setTimeout((function(){return e=!0}),0);var t=XMLHttpRequest;(0,a.logDebugMessage)("addInterceptorsToXMLHttpRequest called"),XMLHttpRequest=function(){var n=new t,f=!e;function g(e){f?setTimeout((function(){e()}),0):e()}var h,p,v=this,b=[],m=[],I={},y=new Map,w="",k=!1,R=void 0;function S(e,t){var n=y.get(e);(0,a.logDebugMessage)("XHRInterceptor dispatching ".concat(t.type," to ").concat(n?n.size:0," listeners")),n&&Array.from(n).forEach((function(e){return e.apply(v,[t])}))}function T(){return r(this,void 0,void 0,(function(){var e,n;return o(this,(function(r){switch(r.label){case 0:if(void 0===R)throw new Error("Should never come here..");return(0,a.logDebugMessage)("XHRInterceptor.handleRetryPostRefreshing: preRequestIdToken "+R.status),[4,(0,i.onUnauthorisedResponse)(R)];case 1:if("RETRY"!==(e=r.sent()).result){if((0,a.logDebugMessage)("XHRInterceptor.handleRetryPostRefreshing: Not retrying original request "+!!e.error),void 0!==e.error)throw e.error;return[2,!0]}return(0,a.logDebugMessage)("XHRInterceptor.handleRetryPostRefreshing: Retrying original request"),n=new t,E(v,n,!0),b.forEach((function(e){e(n)})),C(n,p),[2,!1]}}))}))}function x(e){return r(this,void 0,void 0,(function(){var t,n,r,s,u,l,f,g;return o(this,(function(o){switch(o.label){case 0:if(k)return(0,a.logDebugMessage)("XHRInterceptor.handleResponse: Returning without interception"),[2,!0];o.label=1;case 1:o.trys.push([1,20,,24]),o.label=2;case 2:return o.trys.push([2,,14,19]),(0,a.logDebugMessage)("XHRInterceptor.handleResponse: Interception started"),c.ProcessState.getInstance().addState(c.PROCESS_STATE.CALLING_INTERCEPTION_RESPONSE),t=e.status,n=new Headers(e.getAllResponseHeaders().trim().split("\r\n").map((function(e){return e.split(": ")}))),(r=n.get("id-refresh-token"))?((0,a.logDebugMessage)("XHRInterceptor.handleResponse: Setting sIRTFrontend: "+r),[4,(0,i.setIdRefreshToken)(r,t)]):[3,4];case 3:o.sent(),o.label=4;case 4:return t!==i.default.config.sessionExpiredStatusCode?[3,6]:((0,a.logDebugMessage)("responseInterceptor: Status code is: "+t),[4,T()]);case 5:return[2,o.sent()];case 6:return t!==i.default.config.invalidClaimStatusCode?[3,8]:[4,(0,i.onInvalidClaimResponse)({data:JSON.parse(e.responseText)})];case 7:o.sent(),o.label=8;case 8:return(s=n.get("anti-csrf"))?[4,(0,i.getIdRefreshToken)(!0)]:[3,11];case 9:return"EXISTS"!==(u=o.sent()).status?[3,11]:((0,a.logDebugMessage)("XHRInterceptor.handleResponse: Setting anti-csrf token"),[4,i.AntiCsrfToken.setItem(u.token,s)]);case 10:o.sent(),o.label=11;case 11:return(l=n.get("front-token"))?((0,a.logDebugMessage)("XHRInterceptor.handleResponse: Setting sFrontToken: "+l),[4,i.FrontToken.setItem(l)]):[3,13];case 12:o.sent(),o.label=13;case 13:return[2,!0];case 14:return(0,a.logDebugMessage)("XHRInterceptor.handleResponse: doFinallyCheck running"),[4,(0,i.getIdRefreshToken)(!1)];case 15:return"EXISTS"===o.sent().status?[3,18]:((0,a.logDebugMessage)("XHRInterceptor.handleResponse: sIRTFrontend doesn't exist, so removing anti-csrf and sFrontToken"),[4,i.AntiCsrfToken.removeToken()]);case 16:return o.sent(),[4,i.FrontToken.removeToken()];case 17:o.sent(),o.label=18;case 18:return[7];case 19:return[3,24];case 20:return f=o.sent(),(0,a.logDebugMessage)("XHRInterceptor.handleResponse: caught error"),void 0===f.status?[3,22]:[4,d(f)];case 21:if(g=o.sent(),I.status=g.status,I.statusText=g.statusText,I.responseType=g.responseType,h=g.headers,"json"===g.responseType)try{I.response=JSON.parse(g.responseText)}catch(e){I.response=g.responseText}else I.response=g.responseText;return I.responseText=g.responseText,[3,23];case 22:S("error",new Event("error")),o.label=23;case 23:return[2,!0];case 24:return[2]}}))}))}v.onload=null,v.onreadystatechange=null,v.onloadend=null,v.addEventListener=function(e,t,n){var r=y.get(e);void 0===r&&(r=new Set,y.set(e,r)),r.add(t)},v.removeEventListener=function(e,t){var n=y.get(e);void 0===n&&(n=new Set,y.set(e,n)),n.delete(t)},v.open=function(e,t){(0,a.logDebugMessage)("XHRInterceptor.open called");var r=arguments;b.push((function(e){e.open.apply(e,r)})),w=t;try{k="string"==typeof w&&!(0,s.shouldDoInterceptionBasedOnUrl)(w,i.default.config.apiDomain,i.default.config.cookieDomain)||"string"!=typeof w&&!(0,s.shouldDoInterceptionBasedOnUrl)(w.toString(),i.default.config.apiDomain,i.default.config.cookieDomain)}catch(e){if("Please provide a valid domain name"!==e.message)throw e;(0,a.logDebugMessage)("XHRInterceptor.open: Trying shouldDoInterceptionBasedOnUrl with location.origin"),k=!(0,s.shouldDoInterceptionBasedOnUrl)(u.default.getReferenceOrThrow().windowHandler.location.getOrigin(),i.default.config.apiDomain,i.default.config.cookieDomain)}g((function(){return n.open.apply(n,r)}))},v.send=function(e){C(n,p=e)},v.setRequestHeader=function(e,t){k?g((function(){return n.setRequestHeader(e,t)})):"anti-csrf"!==e&&(b.push((function(n){n.setRequestHeader(e,t)})),m.push({name:e,value:t}),g((function(){return n.setRequestHeader(e,t)})))};var D=void 0;function E(e,n,r){var o,s=["load","loadend","readystatechange"];(0,a.logDebugMessage)("XHRInterceptor.setUpXHR called");for(var i=function(e){(0,a.logDebugMessage)("XHRInterceptor added listener for event ".concat(e)),n.addEventListener(e,(function(t){(0,a.logDebugMessage)("XHRInterceptor got event ".concat(e)),s.includes(e)||S(e,t)}))},u=0,c=l;u<c.length;u++)i(c[u]);if(n.onload=function(t){void 0===o&&(o=x(n)),o.then((function(n){n&&(e.onload&&e.onload(t),S("load",t))}))},n.onreadystatechange=function(r){n.readyState===t.DONE?(void 0===o&&(o=x(n)),o.then((function(t){t&&(e.onreadystatechange&&e.onreadystatechange(r),S("readystatechange",r))}))):(e.onreadystatechange&&e.onreadystatechange(r),S("readystatechange",r))},n.onloadend=function(t){void 0===o&&(o=x(n)),o.then((function(n){n&&(e.onloadend&&e.onloadend(t),S("loadend",t))}))},e.getAllResponseHeaders=function(){var e;return h?(e="",h.forEach((function(t,n){return e+="".concat(n,": ").concat(t,"\r\n")}))):e=n.getAllResponseHeaders(),e+"x-supertokens-xhr-intercepted: true\r\n"},e.getResponseHeader=function(e){return"x-supertokens-xhr-intercepted"===e?"true":h?h.get(e):n.getResponseHeader(e)},void 0===D)for(var d in D=[],n)d in e||D.push(d);for(var f=function(t){"function"==typeof n[t]?Object.defineProperty(e,t,{configurable:!0,value:function(){var e=arguments;return r||b.push((function(n){n[t].apply(n,e)})),n[t].apply(n,e)}}):Object.defineProperty(e,t,{configurable:!0,get:function(){return void 0!==I[t]?I[t]:n[t]},set:function(e){r||b.push((function(n){n[t]=e})),(0,a.logDebugMessage)("XHRInterceptor.set[".concat(t,"] = ").concat(e)),n[t]=e}})},g=0,p=D;g<p.length;g++)f(d=p[g])}function C(e,t){var n=this;if((0,a.logDebugMessage)("XHRInterceptor.send: called"),(0,a.logDebugMessage)("XHRInterceptor.send: Value of doNotDoInterception: "+k),k)return(0,a.logDebugMessage)("XHRInterceptor.send: Returning without interception"),void g((function(){return e.send(t)}));(0,a.logDebugMessage)("XHRInterceptor.send: Interception started"),c.ProcessState.getInstance().addState(c.PROCESS_STATE.CALLING_INTERCEPTION_REQUEST),g((function(){return r(n,void 0,void 0,(function(){var n;return o(this,(function(r){switch(r.label){case 0:return[4,(0,i.getIdRefreshToken)(!0)];case 1:return"EXISTS"!==(R=r.sent()).status?[3,3]:[4,i.AntiCsrfToken.getToken(R.token)];case 2:void 0!==(n=r.sent())&&((0,a.logDebugMessage)("XHRInterceptor.send: Adding anti-csrf token to request"),e.setRequestHeader("anti-csrf",n)),r.label=3;case 3:return i.default.config.autoAddCredentials&&((0,a.logDebugMessage)("XHRInterceptor.send: Adding credentials include"),v.withCredentials=!0),m.some((function(e){return"rid"===e.name}))?(0,a.logDebugMessage)("XHRInterceptor.send: rid header was already there in request"):((0,a.logDebugMessage)("XHRInterceptor.send: Adding rid header: anti-csrf"),e.setRequestHeader("rid","anti-csrf")),(0,a.logDebugMessage)("XHRInterceptor.send: Making user's http call"),[2,e.send(t)]}}))}))}))}E(v,n,!1)},XMLHttpRequest.__original=t}},895:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(i,a)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var s=n(142),i="browser-tabs-lock-key";function a(e){return new Promise((function(t){return setTimeout(t,e)}))}function u(e){for(var t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",n="",r=0;r<e;r++)n+=t[Math.floor(Math.random()*t.length)];return n}var c=function(){function e(){this.acquiredIatSet=new Set,this.id=Date.now().toString()+u(15),this.acquireLock=this.acquireLock.bind(this),this.releaseLock=this.releaseLock.bind(this),this.releaseLock__private__=this.releaseLock__private__.bind(this),this.waitForSomethingToChange=this.waitForSomethingToChange.bind(this),this.refreshLockWhileAcquired=this.refreshLockWhileAcquired.bind(this),void 0===e.waiters&&(e.waiters=[])}return e.prototype.acquireLock=function(t,n){return void 0===n&&(n=5e3),r(this,void 0,void 0,(function(){var r,s,c,l,d,f;return o(this,(function(o){switch(o.label){case 0:r=Date.now()+u(4),s=Date.now()+n,c=i+"-"+t,l=window.localStorage,o.label=1;case 1:return Date.now()<s?[4,a(30)]:[3,8];case 2:return o.sent(),null!==l.getItem(c)?[3,5]:(d=this.id+"-"+t+"-"+r,[4,a(Math.floor(25*Math.random()))]);case 3:return o.sent(),l.setItem(c,JSON.stringify({id:this.id,iat:r,timeoutKey:d,timeAcquired:Date.now(),timeRefreshed:Date.now()})),[4,a(30)];case 4:return o.sent(),null!==(f=l.getItem(c))&&(f=JSON.parse(f)).id===this.id&&f.iat===r?(this.acquiredIatSet.add(r),this.refreshLockWhileAcquired(c,r),[2,!0]):[3,7];case 5:return e.lockCorrector(),[4,this.waitForSomethingToChange(s)];case 6:o.sent(),o.label=7;case 7:return r=Date.now()+u(4),[3,1];case 8:return[2,!1]}}))}))},e.prototype.refreshLockWhileAcquired=function(e,t){return r(this,void 0,void 0,(function(){var n=this;return o(this,(function(i){return setTimeout((function(){return r(n,void 0,void 0,(function(){var n,r;return o(this,(function(o){switch(o.label){case 0:return[4,s.default().lock(t)];case 1:return o.sent(),this.acquiredIatSet.has(t)?(n=window.localStorage,null===(r=n.getItem(e))?(s.default().unlock(t),[2]):((r=JSON.parse(r)).timeRefreshed=Date.now(),n.setItem(e,JSON.stringify(r)),s.default().unlock(t),this.refreshLockWhileAcquired(e,t),[2])):(s.default().unlock(t),[2])}}))}))}),1e3),[2]}))}))},e.prototype.waitForSomethingToChange=function(t){return r(this,void 0,void 0,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,new Promise((function(n){var r=!1,o=Date.now(),s=!1;function i(){if(s||(window.removeEventListener("storage",i),e.removeFromWaiting(i),clearTimeout(a),s=!0),!r){r=!0;var t=50-(Date.now()-o);t>0?setTimeout(n,t):n()}}window.addEventListener("storage",i),e.addToWaiting(i);var a=setTimeout(i,Math.max(0,t-Date.now()))}))];case 1:return n.sent(),[2]}}))}))},e.addToWaiting=function(t){this.removeFromWaiting(t),void 0!==e.waiters&&e.waiters.push(t)},e.removeFromWaiting=function(t){void 0!==e.waiters&&(e.waiters=e.waiters.filter((function(e){return e!==t})))},e.notifyWaiters=function(){void 0!==e.waiters&&e.waiters.slice().forEach((function(e){return e()}))},e.prototype.releaseLock=function(e){return r(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,this.releaseLock__private__(e)];case 1:return[2,t.sent()]}}))}))},e.prototype.releaseLock__private__=function(t){return r(this,void 0,void 0,(function(){var n,r,a;return o(this,(function(o){switch(o.label){case 0:return n=window.localStorage,r=i+"-"+t,null===(a=n.getItem(r))?[2]:(a=JSON.parse(a)).id!==this.id?[3,2]:[4,s.default().lock(a.iat)];case 1:o.sent(),this.acquiredIatSet.delete(a.iat),n.removeItem(r),s.default().unlock(a.iat),e.notifyWaiters(),o.label=2;case 2:return[2]}}))}))},e.lockCorrector=function(){for(var t=Date.now()-5e3,n=window.localStorage,r=Object.keys(n),o=!1,s=0;s<r.length;s++){var a=r[s];if(a.includes(i)){var u=n.getItem(a);null!==u&&(void 0===(u=JSON.parse(u)).timeRefreshed&&u.timeAcquired<t||void 0!==u.timeRefreshed&&u.timeRefreshed<t)&&(n.removeItem(a),o=!0)}}o&&e.notifyWaiters()},e.waiters=void 0,e}();t.default=c},142:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){var e=this;this.locked=new Map,this.addToLocked=function(t,n){var r=e.locked.get(t);void 0===r?void 0===n?e.locked.set(t,[]):e.locked.set(t,[n]):void 0!==n&&(r.unshift(n),e.locked.set(t,r))},this.isLocked=function(t){return e.locked.has(t)},this.lock=function(t){return new Promise((function(n,r){e.isLocked(t)?e.addToLocked(t,n):(e.addToLocked(t),n())}))},this.unlock=function(t){var n=e.locked.get(t);if(void 0!==n&&0!==n.length){var r=n.pop();e.locked.set(t,n),void 0!==r&&setTimeout(r,0)}else e.locked.delete(t)}}return e.getInstance=function(){return void 0===e.instance&&(e.instance=new e),e.instance},e}();t.default=function(){return n.getInstance()}},225:function(e,t){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.getProxyObject=void 0,t.getProxyObject=function(e){for(var t=n(n({},e),{_call:function(e,t){throw new Error("This function should only be called through the recipe object")}}),r=function(e){"_call"!==e&&(t[e]=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return this._call(e,t)})},o=0,s=Object.keys(t);o<s.length;o++)r(s[o]);return t}},333:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OverrideableBuilder=void 0;var r=n(225),o=function(){function e(e){this.layers=[e],this.proxies=[]}return e.prototype.override=function(e){for(var t=(0,r.getProxyObject)(this.layers[0]),n=e(t,this),o=0,s=Object.keys(this.layers[0]);o<s.length;o++){var i=s[o];n[i]===t[i]||"_call"===i?delete n[i]:void 0===n[i]&&(n[i]=null)}return this.layers.push(n),this.proxies.push(t),this},e.prototype.build=function(){var e=this;if(this.result)return this.result;this.result={};for(var t=0,n=this.layers;t<n.length;t++)for(var r=n[t],o=0,s=Object.keys(r);o<s.length;o++){var i=s[o],a=r[i];void 0!==a&&(this.result[i]=null===a?void 0:"function"==typeof a?a.bind(this.result):a)}for(var u=function(t){c.proxies[t]._call=function(n,r){for(var o=t;o>=0;--o){var s=e.layers[o][n];if(null!=s)return s.bind(e.result).apply(void 0,r)}}},c=this,l=0;l<this.proxies.length;++l)u(l);return this.result},e}();t.OverrideableBuilder=o,t.default=o}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var s=t[r]={exports:{}};return e[r].call(s.exports,s,s.exports,n),s.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}();var r=n(280);supertokens=r})();